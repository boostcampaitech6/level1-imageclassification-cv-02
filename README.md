# ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœ Image Classification

## ğŸ˜Š íŒ€ êµ¬ì„±ì›
<div align="center">
<table>
  <tr>
    <td align="center"><a href="https://github.com/seheeAn"><img src="https://avatars.githubusercontent.com/u/49268298?v=4" width="100px;" alt=""/><br /><sub><b>ì•ˆì„¸í¬</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/Dong-Uri"><img src="https://avatars.githubusercontent.com/u/109489851?v=4" width="100px;" alt=""/><br /><sub><b>ì´ë™ìš°</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/Megi2"><img src="https://avatars.githubusercontent.com/u/65165556?v=4" width="100px;" alt=""/><br /><sub><b>ì „ì§„í•˜</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/MalMyeong"><img src="https://avatars.githubusercontent.com/u/61974115?v=4" width="100px;" alt=""/><br /><sub><b>ì¡°ëª…í˜„</b></sub><br />
    </td>
        <td align="center"><a href="https://github.com/ChoeHyeonWoo"><img src="https://avatars.githubusercontent.com/u/78468396?v=4" width="100px;" alt=""/><br /><sub><b>ìµœí˜„ìš°</b></sub><br />
    </td>
  </tr>
</table>
</div>

<br />

## ğŸ˜· í”„ë¡œì íŠ¸ ê°œìš”
ì§€ë‚œ 3ë…„ê°„ COVID-19ëŠ” ì „ ì„¸ê³„ì ìœ¼ë¡œ ê²½ì œì™€ ìƒì‚° í™œë™ì— í° ì œì•½ì„ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ì´ ë°”ì´ëŸ¬ìŠ¤ëŠ” ì£¼ë¡œ ì…ê³¼ í˜¸í¡ê¸°ì—ì„œ ë‚˜ì˜¤ëŠ” ë¹„ë§ì„ í†µí•´ ì „íŒŒë˜ë¯€ë¡œ, ê³µê³µì¥ì†Œì—ì„œì˜ ì˜¬ë°”ë¥¸ ë§ˆìŠ¤í¬ ì°©ìš©ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ê³µê³µì¥ì†Œì—ì„œ ëª¨ë“  ì‚¬ëŒì˜ ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì€ ì¸ë ¥ì  ì œì•½ì´ ìˆìœ¼ë¯€ë¡œ, ì¹´ë©”ë¼ë¥¼ í†µí•´ ì‚¬ëŒì˜ ì–¼êµ´ ì´ë¯¸ì§€ë§Œìœ¼ë¡œ ë§ˆìŠ¤í¬ ì°©ìš© ì—¬ë¶€ë¥¼ ìë™ìœ¼ë¡œ íŒë³„í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì˜ ê°œë°œì´ í•„ìš”í•©ë‹ˆë‹¤. 

<br />

## ğŸ“… í”„ë¡œì íŠ¸ ì¼ì •
í”„ë¡œì íŠ¸ ì „ì²´ ì¼ì •

- 2023.12.11 ~ 2023.12.22

í”„ë¡œì íŠ¸ ì„¸ë¶€ ì¼ì •  
<img align="center" src="imgs/schedule.png" width="800" height="400">

<br />

## ğŸ† í”„ë¡œì íŠ¸ ê²°ê³¼
- Private ë¦¬ë”ë³´ë“œì—ì„œ ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.  
<img align="center" src="imgs/result.png" width="600" height="80">

<br />

## ğŸ“ ë°ì´í„°ì…‹ êµ¬ì¡°
```
ğŸ“¦datasets
 â”£ ğŸ“‚eval
 â”ƒ â”£ ğŸ“‚images
 â”ƒ â”£ ğŸ“œinfo.csv
 â”£ ğŸ“‚train
 â”ƒ â”£ ğŸ“‚images
 â”ƒ â”— ğŸ“œtrain.csv
 â”— ğŸ“‚trainQA
   â”£ ğŸ“‚images
   â”— ğŸ“œtrain.csv
```
ì´ ì½”ë“œëŠ” `ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech`ì—ì„œ ì œê³µí•˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„±ì„ ë”°ë¦…ë‹ˆë‹¤. 
- trainì€ í•™ìŠµì— ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ì…‹
- evalì€ í‰ê°€ì— ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ì…‹
- trainQAëŠ” train ë°ì´í„°ì—ì„œ miss labelingëœ ë°ì´í„°ë¥¼ ìˆ˜ì •í•œ í´ë”ì…ë‹ˆë‹¤.

<br />

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
ğŸ“¦level1-imageclassification-cv-02
 â”£ ğŸ“‚.github
 â”ƒ â”£ ğŸ“‚ISSUE_TEMPLATE
 â”ƒ â”ƒ â”£ ğŸ“œbug_report.md
 â”ƒ â”ƒ â”— ğŸ“œfeature_request.md
 â”ƒ â”£ ğŸ“œ.keep
 â”ƒ â”— ğŸ“œPULL_REQUEST_TEMPLATE.md
 â”£ ğŸ“‚notebook
 â”ƒ â”— ğŸ“œsample_submission.ipynb
 â”£ ğŸ“‚redis_model_scheduler
 â”ƒ â”£ ğŸ“œredis_publisher.py
 â”ƒ â”— ğŸ“œschedule_search.py
 â”£ ğŸ“œ.gitignore
 â”£ ğŸ“œdataset.py
 â”£ ğŸ“œensemble_weights.py
 â”£ ğŸ“œfunction.py
 â”£ ğŸ“œinference.py
 â”£ ğŸ“œk-fold-inference.py
 â”£ ğŸ“œloss.py
 â”£ ğŸ“œmodel.py
 â”£ ğŸ“œrequirements.txt
 â”— ğŸ“œtrain.py
```

#### 1) `dataset.py`
- Dataset classì™€ Augmentation classë¥¼ êµ¬í˜„í•œ íŒŒì¼
- CustomAugmentation, ImgaugAugmentation êµ¬í˜„
#### 2) `loss.py`
- ì´ë¯¸ì§€ ë¶„ë¥˜ì— ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ Loss ë“¤ì„ ì •ì˜í•œ íŒŒì¼
- Cross Entropy, Focal Loss, Label Smoothing Loss, F1 Loss êµ¬í˜„
#### 3) `model.py`
- í•™ìŠµì— ì‚¬ìš©í•œ Model í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•œ íŒŒì¼ 
- resnet34, resnet50, Resnet34CategoryModel, efficientnet_b0, efficientnet_b1, efficientnet_b2, efficientnet_b5, vit_base_patch16_224, vit_B_16_imagenet1k, vit-age-classifier
#### 4) `train.py`
- ì…ë ¥ config ê°’ì„ training í•¨ìˆ˜ì— ì „ë‹¬í•˜ëŠ” íŒŒì¼
- wandbë¥¼ í†µí•œ í•™ìŠµ ì§„í–‰ìƒí™© ë¡œê¹… êµ¬í˜„
#### 5) `function.py`
- ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ì˜¨ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ train ë°ì´í„°ì…‹ìœ¼ë¡œ ëª¨ë¸ í•™ìŠµì„ ì§„í–‰í•˜ëŠ” íŒŒì¼
- ì¡°ê±´ì— ë§ëŠ” í•™ìŠµ(k-fold, classë³„ í•™ìŠµ)ì„ ì§„í–‰ í›„ best ëª¨ë¸ì„ ì €ì¥
#### 6) `inference`
- `inference.py` : í•™ìŠµ ì™„ë£Œëœ ëª¨ë¸ì„ í†µí•´ eval setì— ëŒ€í•œ ì˜ˆì¸¡ ê°’ì„ êµ¬í•˜ê³  ì´ë¥¼ .csv í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” íŒŒì¼ 
- `k-fold-inference.py` : hard voting ë°©ì‹ìœ¼ë¡œ k-foldë¥¼ ì ìš©í•˜ì—¬ ì˜ˆì¸¡ê°’ì„ êµ¬í•˜ê³ , ì´ë¥¼ .csv í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ëŠ” íŒŒì¼
#### 7) `ensemble_weights.py`
- ì—¬ëŸ¬ í•™ìŠµ ëª¨ë¸ë“¤ë¡œ ìƒì„±í•œ ê²°ê³¼ë“¤ì„ hard votingí•˜ì—¬ ì•™ìƒë¸”ëœ ê²°ê³¼ë¥¼ ì¶”ë¡ í•˜ëŠ” íŒŒì¼
- inference íŒŒì¼ì„ í†µí•´ ìƒì„±ëœ .csv íŒŒì¼ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ìƒˆë¡œìš´ .csv íŒŒì¼ì„ ìƒì„± ë° ì €ì¥
#### 8) `redis_model_scheduler`
- `redis_publisher.py` : redis queueì— ì›í•˜ëŠ” í•™ìŠµ config ê°’ì„ ì „ë‹¬í•˜ëŠ” íŒŒì¼
- `schedlue_search.py` : redis queueì—ì„œ í•™ìŠµì„ ê¸°ë‹¤ë¦¬ê³  ìˆëŠ” config ê°’ì„ ì¡°íšŒ ë° ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ êµ¬í˜„

<br />

## âš™ï¸ requirements

- black==23.9.1
- matplotlib==3.8.2
- numpy==1.26.0
- pandas==2.1.4
- Pillow==9.4.0
- python-dotenv==1.0.0
- scikit-learn==1.2.2
- tensorboard==2.15.1
- torch==2.1.0
- torchvision==0.16.0
- timm==0.9.12
- transformers==4.36.2
- pytorch-pretrained-vit==0.0.7
- wandb==0.16.1
- redis==5.0.1
- GitPython==3.1.40
- imgaug==0.4.0
- efficientnet-pytorch ==0.7.1

`pip3 install -r requirements.txt`

<br />

## â–¶ï¸ ì‹¤í–‰ ë°©ë²•

#### Train
`python train.py --name [ì‹¤í—˜ëª…]`

#### Inferecne
`python inference.py --model_dir [ëª¨ë¸ì €ì¥ê²½ë¡œ]`

#### schedulerë¥¼ í†µí•œ ì‹¤í–‰
`python redis_publisher.py --ip [ipì£¼ì†Œ] --port [portë²ˆí˜¸] --user [ì´ë¦„]`  

`python ~~.py --ip [ipì£¼ì†Œ] --port [portë²ˆí˜¸] --mode [modeì´ë¦„]`


<br />

## âœï¸ Wrap-Up Report   
- [Wrap-Up Report](ë§í¬)